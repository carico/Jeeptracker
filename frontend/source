<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jeepney App - Detailed Receipt</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <style>
        /* --- GLOBAL RESET --- */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #111; height: 100vh; width: 100vw; overflow: hidden; display: flex; justify-content: center; align-items: center; }

        .app-container {
            width: 100%; height: 100%; max-width: 450px; position: relative; background: #fff; overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        /* --- 1. LOGIN SCREEN --- */
        #login-screen {
            width: 100%; height: 100%; background: linear-gradient(135deg, #29B5F1 0%, #164A86 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            position: absolute; top: 0; left: 0; z-index: 100; transition: opacity 0.5s ease, visibility 0.5s;
        }
        .circle { position: absolute; border-radius: 50%; background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(5px); pointer-events: none; }
        .c1 { width: 200px; height: 200px; top: -50px; left: -50px; animation: float 6s infinite ease-in-out; }
        .c2 { width: 300px; height: 300px; bottom: -80px; right: -80px; animation: float 8s infinite ease-in-out reverse; }
        
        .login-card { width: 85%; background: rgba(41, 181, 241, 0.65); backdrop-filter: blur(15px); padding: 40px 30px; border-radius: 35px; border: 1px solid rgba(255,255,255,0.2); box-shadow: 0 20px 40px rgba(0,0,0,0.2); display: flex; flex-direction: column; align-items: center; }
        .user-icon { width: 80px; height: 80px; background: #1E3263; border-radius: 50%; display: flex; justify-content: center; align-items: center; border: 4px solid #75D6FF; margin-bottom: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .user-icon svg { width: 40px; fill: white; }
        h2 { color: #1E3263; font-size: 18px; font-weight: 800; letter-spacing: 2px; margin-bottom: 5px; }
        .subtitle { color: white; font-size: 10px; margin-bottom: 30px; opacity: 0.9; font-weight: 600; }
        .input-group { width: 100%; margin-bottom: 15px; position: relative; }
        .input-group input { width: 100%; background: rgba(0,0,0,0.15); border: 1px solid rgba(255,255,255,0.2); border-radius: 50px; padding: 12px 15px 12px 45px; color: white; font-size: 13px; outline: none; box-shadow: inset 0 2px 5px rgba(0,0,0,0.1); }
        .input-group input::placeholder { color: rgba(255,255,255,0.8); }
        .icon-overlay { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); font-size: 16px; filter: grayscale(1) brightness(100); }
        .login-btn { width: 100%; padding: 14px; background: linear-gradient(180deg, #1E3263 0%, #112042 100%); color: white; border: none; border-radius: 50px; font-weight: bold; font-size: 14px; box-shadow: 0 10px 20px rgba(0,0,0,0.25); cursor: pointer; margin-top: 10px; }

        /* --- 2. MAIN APP & MAP --- */
        #main-app { display: none; width: 100%; height: 100%; position: relative; }
        
        /* Screen Transitions */
        .screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; visibility: hidden; transition: opacity 0.3s; z-index: 10; background: white; display: flex; flex-direction: column; }
        .screen.active { opacity: 1; visibility: visible; z-index: 20; }

        #map-canvas { width: 100%; height: 100%; z-index: 0; }
        
        .top-ui { position: absolute; top: 40px; left: 20px; right: 20px; display: flex; flex-direction: column; gap: 15px; z-index: 10; }
        .glass-box { 
            background: rgba(41, 181, 241, 0.85); backdrop-filter: blur(12px); 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2), inset 0 1px 1px rgba(255,255,255,0.4); 
            color: white; border-radius: 20px; border: 1px solid rgba(255,255,255,0.2); 
        }
        .search-bar { border-radius: 50px; padding: 0 15px; height: 50px; display: flex; align-items: center; }
        .bare-input { background: transparent; border: none; outline: none; color: white; font-size: 15px; font-weight: 600; width: 100%; margin-left: 10px; }
        .bare-input::placeholder { color: rgba(255,255,255,0.8); }
        .trip-card { padding: 15px; display: flex; align-items: center; }
        .trip-points { display: flex; flex-direction: column; align-items: center; margin-right: 15px; }
        .dot { width: 10px; height: 10px; background: white; border-radius: 50%; border: 2px solid #1E3263; }
        .line { width: 2px; height: 30px; background: rgba(255,255,255,0.5); margin: 2px 0; }
        .pin { width: 12px; height: 12px; background: #FF4D4D; border-radius: 50%; border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .divider { height: 1px; background: rgba(255,255,255,0.3); width: 100%; margin: 8px 0; }

        .action-btn-container { position: absolute; bottom: 110px; right: 20px; z-index: 20; }
        .find-jeep-btn { 
            background: #FF9F1C; color: white; border: none; padding: 12px 20px; border-radius: 30px; font-weight: bold; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 10px rgba(255, 159, 28, 0.4);
            display: flex; align-items: center; gap: 8px; cursor: pointer; transition: transform 0.2s; 
        }

        /* --- 3. RIDE PANEL --- */
        #ride-panel { position: absolute; bottom: -700px; left: 0; width: 100%; background: #164A86; border-top-left-radius: 40px; border-top-right-radius: 40px; padding: 10px 0 100px 0; z-index: 30; box-shadow: 0 -10px 40px rgba(0,0,0,0.4); transition: bottom 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; flex-direction: column; }
        #ride-panel.show { bottom: 0; }
        .handle { width: 60px; height: 6px; background: rgba(255,255,255,0.2); border-radius: 10px; margin: 15px auto; }
        .panel-content { padding: 0 30px; color: white; display: flex; flex-direction: column; }
        .panel-title { font-size: 40px; font-weight: 800; margin-bottom: 25px; margin-top: 10px; letter-spacing: -1px; }
        .toggle-container { background: white; border-radius: 20px; padding: 5px; display: flex; position: relative; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); flex-shrink: 0; }
        .toggle-btn { flex: 1; padding: 15px 0; text-align: center; font-weight: 800; font-size: 14px; z-index: 2; cursor: pointer; border: none; background: none; transition: color 0.3s; }
        .toggle-btn.active { color: white; }
        .toggle-btn.inactive { color: #888; }
        .slider { position: absolute; top: 5px; bottom: 5px; left: 5px; width: calc(50% - 5px); background: #29B5F1; border-radius: 15px; transition: transform 0.3s ease; z-index: 1; box-shadow: 0 2px 10px rgba(41, 181, 241, 0.5); }
        
        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        .ride-info { font-size: 20px; margin-bottom: 20px; font-weight: 500; }
        .ride-info small { opacity: 0.7; font-size: 14px; display: block; margin-top: 5px; text-transform: uppercase; letter-spacing: 1px;}
        .separator { width: 100%; height: 1px; background: rgba(255,255,255,0.1); margin-bottom: 20px; }
        .traffic-container { display: flex; align-items: flex-end; gap: 8px; height: 60px; margin-bottom: 10px; padding: 0 10px; }
        .bar { flex: 1; background: rgba(128, 128, 128, 0.4); border-top-left-radius: 8px; border-top-right-radius: 8px; }
        .bar.active { background: linear-gradient(180deg, #B8FEB6 0%, #6cd669 100%); box-shadow: 0 0 15px rgba(184, 254, 182, 0.4); }
        .time-labels { display: flex; justify-content: space-between; font-size: 11px; opacity: 0.6; padding: 0 10px; font-weight: 600; }
        
        .fare-details { font-size: 18px; margin-bottom: 20px; line-height: 1.6; }
        .fare-highlight { font-weight: 700; color: #B8FEB6; font-size: 22px; display: block; margin-top: 5px; }
        .qr-section { display: flex; align-items: center; gap: 15px; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; cursor: pointer; transition: background 0.2s; margin-bottom: 20px; border: 1px dashed rgba(255,255,255,0.5); }
        .qr-section:active { background: rgba(255,255,255,0.2); }
        .qr-icon { width: 40px; height: 40px; fill: white; }

        /* --- 4. SUB-SCREENS --- */
        #qr-screen, #generate-screen, #upload-screen, #receipt-screen, #account-menu, #edit-profile { z-index: 60; background: #000; }
        #qr-screen.active, #generate-screen.active, #upload-screen.active, #receipt-screen.active, #account-menu.active, #edit-profile.active { opacity: 1; visibility: visible; }
        
        /* Shared Header */
        .qr-header { background: #164A86; border-radius: 0 0 30px 30px; padding: 40px 20px 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 5px 20px rgba(0,0,0,0.3); z-index: 10; flex-shrink: 0; }
        .qr-header h2 { color: white; font-size: 18px; margin: 0; font-weight: 700; }
        .icon-btn { background: none; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; }
        .icon-btn:active { background: rgba(255,255,255,0.2); }
        .icon-white { width: 24px; height: 24px; fill: white; }
        
        .sub-content { flex: 1; display: flex; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; background: #f4f7fa; }

        /* QR Scanner */
        .camera-view { flex: 1; position: relative; display: flex; justify-content: center; align-items: center; background: #111; overflow: hidden; }
        .camera-feed-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: url('https://upload.wikimedia.org/wikipedia/commons/3/3a/Jeepney_interior_2.jpg') no-repeat center center; background-size: cover; opacity: 0.4; }
        .scanner-box { width: 250px; height: 250px; border: 4px dashed #21A8D7; border-radius: 20px; box-shadow: 0 0 0 1000px rgba(0,0,0,0.6); z-index: 2; position: relative; animation: pulse-border 2s infinite; }
        @keyframes pulse-border { 0% { border-color: #21A8D7; } 50% { border-color: #B8FEB6; } 100% { border-color: #21A8D7; } }
        .scan-line { width: 100%; height: 2px; background: #B8FEB6; position: absolute; top: 10%; left: 0; box-shadow: 0 0 10px #B8FEB6; animation: scan 3s infinite linear; }
        @keyframes scan { 0% { top: 10%; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { top: 90%; opacity: 0; } }
        .qr-modal { position: absolute; bottom: 180px; left: 30px; right: 30px; background: rgba(255,255,255,0.95); border-radius: 20px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); z-index: 20; text-align: center; animation: slideUp 0.5s ease-out; border: 3px solid #808080; }
        .modal-title { color: #515151; font-size: 18px; font-weight: 800; margin-bottom: 10px; display: block; }
        .modal-text { color: #808080; font-size: 13px; font-weight: 600; line-height: 1.4; margin-bottom: 15px; display: block; }
        .btn-ok { background: #164A86; color: white; border: none; padding: 8px 30px; border-radius: 20px; font-weight: bold; cursor: pointer; float: right; }
        .qr-controls { height: 160px; background: #000; display: flex; flex-direction: column; justify-content: center; }
        .btn-row { display: flex; justify-content: center; gap: 40px; margin-bottom: 15px; }
        .circle-btn { width: 70px; height: 70px; border-radius: 20px; border: 2px dashed #808080; background: transparent; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: transform 0.1s; }
        .circle-btn:active { transform: scale(0.95); background: rgba(255,255,255,0.1); }
        .plus-icon { font-size: 40px; color: white; font-weight: 300; }
        .labels-row { display: flex; justify-content: center; gap: 40px; }
        .label-text { color: white; font-size: 12px; font-weight: bold; width: 70px; text-align: center; }

        /* Generate/Upload QR */
        .qr-display-card { background: white; border-radius: 20px; padding: 20px; width: 100%; max-width: 320px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; margin-bottom: 20px; cursor: pointer; transition: transform 0.2s; }
        .qr-display-card:active { transform: scale(0.98); }
        .generated-qr-img { width: 180px; height: 180px; margin: 20px 0; }
        .pay-option-row { background: white; width: 100%; padding: 15px; border-radius: 15px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 10px rgba(0,0,0,0.1); cursor: pointer; }
        .upload-tabs { padding: 10px; display: flex; gap: 10px; background: white; margin-top: 10px; border-radius: 15px; width: 90%; margin-left: auto; margin-right: auto; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .u-tab { flex: 1; padding: 12px; border-radius: 12px; border: none; font-weight: bold; font-size: 14px; cursor: pointer; transition: all 0.3s; }
        .u-tab.active { background: #164A86; color: white; }
        .u-tab.inactive { background: #e0e0e0; color: #555; }
        .photo-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; }
        .photo-item { width: 100%; aspect-ratio: 1; border-radius: 10px; overflow: hidden; background: #ddd; cursor: pointer; }
        .photo-item img { width: 100%; height: 100%; object-fit: cover; }
        .collection-list { display: flex; flex-direction: column; gap: 15px; width: 100%; }
        .coll-row { display: flex; gap: 10px; }
        .coll-card { flex: 1; background: white; border-radius: 15px; padding: 10px; display: flex; flex-direction: column; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); cursor: pointer; }
        .coll-thumb { width: 100%; height: 100px; background: #eee; border-radius: 10px; margin-bottom: 8px; overflow: hidden; }
        .coll-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .coll-title { font-size: 13px; font-weight: bold; color: #333; }
        .coll-count { font-size: 11px; color: #888; }

        /* RECEIPT SCREEN (UPDATED DETAILS) */
        #receipt-screen { background: #f0f0f0; z-index: 80; }
        .receipt-card { background: white; width: 90%; margin: -20px auto 20px auto; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; position: relative; }
        .receipt-divider { width: 100%; height: 1px; background: #eee; margin: 15px 0; }
        
        .r-row { width: 100%; display: flex; justify-content: space-between; margin-bottom: 8px; }
        .r-label { font-size: 14px; color: #164A86; font-weight: 700; }
        .r-val { font-size: 14px; color: #164A86; font-weight: 700; }
        .r-total-label { font-size: 14px; color: #164A86; font-weight: 700; }
        .r-total-val { font-size: 24px; color: #164A86; font-weight: 800; }
        .sub-detail { font-size: 12px; color: #555; }

        .confirm-box { display: flex; align-items: center; margin-top: 20px; gap: 10px; width: 100%; }
        .checkbox-custom { width: 20px; height: 20px; border: 2px solid #164A86; border-radius: 4px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .checkbox-custom.checked { background: #164A86; }
        .checkbox-custom.checked::after { content: '‚úî'; color: white; font-size: 14px; }
        .pay-btn { background: #164A86; color: white; border: none; padding: 15px 50px; border-radius: 50px; font-weight: bold; font-size: 18px; box-shadow: 0 5px 15px rgba(22, 74, 134, 0.3); margin-top: 20px; opacity: 0.5; pointer-events: none; transition: all 0.3s; }
        .pay-btn.enabled { opacity: 1; pointer-events: auto; }
        .success-icon { width: 60px; height: 60px; background: #4CAF50; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin-bottom: 10px; }
        .success-text { font-size: 22px; color: #164A86; font-weight: 800; margin-bottom: 20px; }

        /* --- 6. ACCOUNT SCREEN --- */
        #account-menu { background: linear-gradient(180deg, #31A7E2 0%, #164A86 100%); z-index: 50; }
        .acc-header { padding: 40px 20px 20px 20px; display: flex; align-items: center; gap: 15px; color: white; position: relative; }
        .acc-avatar { width: 60px; height: 60px; background: white; border-radius: 50%; border: 3px solid rgba(255,255,255,0.3); display: flex; justify-content: center; align-items: center; font-size: 24px; font-weight: bold; color: #164A86; }
        .acc-info { flex: 1; }
        .acc-name { font-size: 18px; font-weight: 700; margin-bottom: 5px; cursor: pointer; }
        .acc-sub { font-size: 12px; opacity: 0.9; }
        .acc-list-container { flex: 1; background: transparent; padding: 10px 0; overflow-y: auto; }
        .acc-item { display: flex; align-items: center; padding: 15px 25px; color: white; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.1); transition: background 0.2s; }
        .acc-item:active { background: rgba(255,255,255,0.1); }
        .acc-icon { width: 24px; height: 24px; margin-right: 15px; fill: white; opacity: 0.9; }
        .acc-label { flex: 1; font-size: 15px; font-weight: 500; }
        .acc-arrow { width: 16px; height: 16px; fill: white; opacity: 0.5; }
        .acc-logout { margin-top: 20px; padding: 15px 25px; display: flex; align-items: center; color: #ffcccc; cursor: pointer; }
        .menu-back { position: absolute; top: 40px; right: 20px; background: rgba(255,255,255,0.2); width: 35px; height: 35px; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; z-index: 5; }

        /* Edit Profile */
        #edit-profile { background: #fff; z-index: 55; }
        .profile-header-bg { height: 180px; background: linear-gradient(180deg, #808080 0%, #333 100%); position: relative; display: flex; flex-direction: column; justify-content: flex-end; padding: 20px; color: white; }
        .back-btn-float { position: absolute; top: 40px; left: 20px; background: rgba(0,0,0,0.3); border: none; border-radius: 50%; width: 35px; height: 35px; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        .p-edit-avatar { position: absolute; bottom: -30px; right: 20px; width: 70px; height: 70px; background: #fff; border-radius: 50%; border: 4px solid #fff; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .p-edit-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .p-header-name { font-size: 22px; font-weight: 700; margin-bottom: 5px; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
        .p-header-sub { font-size: 12px; opacity: 0.9; margin-bottom: 10px; }
        .profile-form { flex: 1; padding: 40px 20px 20px 20px; overflow-y: auto; background: linear-gradient(180deg, #31A7E2 0%, #164A86 100%); }
        .section-title { color: white; font-size: 18px; font-weight: 700; margin-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 10px; }
        .form-group { margin-bottom: 15px; }
        .form-label { color: white; font-size: 12px; margin-bottom: 5px; display: block; font-weight: 600; margin-left: 5px; }
        .form-input { width: 100%; background: rgba(255,255,255,0.2); border: none; border-radius: 10px; padding: 12px; color: white; font-size: 14px; outline: none; backdrop-filter: blur(5px); }
        .form-input::placeholder { color: rgba(255,255,255,0.6); }
        .form-row { display: flex; gap: 10px; }

        /* BOTTOM NAV */
        .bottom-nav { position: absolute; bottom: 0; left: 0; width: 100%; height: 85px; background: #164A86; border-top-left-radius: 30px; border-top-right-radius: 30px; display: flex; justify-content: space-between; align-items: center; padding: 0 50px; z-index: 50; box-shadow: 0 -5px 25px rgba(0,0,0,0.4); }
        .map-fab { position: absolute; top: -30px; left: 50%; transform: translateX(-50%); width: 65px; height: 65px; background: #21A8D7; border: 6px solid #164A86; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 5px 10px rgba(0,0,0,0.3); cursor: pointer; }
        .nav-icon { fill: #8bb3d8; width: 28px; height: 28px; cursor: pointer; transition: fill 0.3s; }
        .nav-icon.active { fill: white; }
        .map-icon { fill: white; width: 28px; height: 28px; }

    </style>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>

    <div class="app-container">
        
        <div id="login-screen" class="screen active">
            <div class="circle c1"></div><div class="circle c2"></div>
            <div class="login-card">
                <div class="user-icon"><svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg></div>
                <h2>USER LOGIN</h2><span class="subtitle">ARE YOU A DRIVER OR PASSENGER?</span>
                <div class="input-group"><span class="icon-overlay">‚úâÔ∏è</span><input type="email" placeholder="EMAIL ID" value="student@univ.ph"></div>
                <div class="input-group"><span class="icon-overlay">üîí</span><input type="password" placeholder="PASSWORD" value="password"></div>
                <button class="login-btn" onclick="handleLogin()">LOGIN</button>
            </div>
        </div>

        <div id="map-view" class="screen">
            <div id="map-canvas"></div>
            <div class="top-ui">
                <div class="glass-box search-bar"><span style="margin-right:10px">üîç</span><input type="text" class="bare-input" placeholder="Search Location"></div>
                <div class="glass-box trip-card"><div class="trip-points"><div class="dot"></div><div class="line"></div><div class="pin"></div></div><div style="width:100%"><input type="text" class="bare-input" placeholder="Your Location" value="SM Batangas"><div class="divider"></div><input type="text" class="bare-input" placeholder="Destination" value="Batangas State U"></div></div>
            </div>
            <div class="action-btn-container" id="find-btn"><button class="find-jeep-btn" onclick="triggerRidePanel()"><span>üöô</span> FIND JEEPNEY</button></div>
            <div id="ride-panel">
                <div class="handle"></div>
                <div class="panel-content">
                    <div class="panel-title">Jeepney Ride</div>
                    <div class="toggle-container"><div class="slider" id="toggle-slider"></div><button class="toggle-btn active" id="btn-eta" onclick="toggleRideTab(0)">ETA</button><button class="toggle-btn inactive" id="btn-pay" onclick="toggleRideTab(1)">FARE PAY</button></div>
                    <div id="tab-eta" class="tab-content active">
                        <div class="ride-info">22 minutes (4.2km)<small>Traffic Conditions:</small></div>
                        <div class="traffic-container"><div class="bar" style="height:40%"></div><div class="bar active" style="height:60%"></div><div class="bar" style="height:50%"></div><div class="bar" style="height:70%"></div><div class="bar" style="height:45%"></div><div class="bar" style="height:30%"></div></div>
                        <div class="time-labels"><span>7am</span><span>8am</span><span>9am</span><span>10am</span></div>
                    </div>
                    <div id="tab-pay" class="tab-content">
                        <div class="fare-details"><div>PASSENGER: STUDENT</div><div class="fare-highlight">DISCOUNT: ‚Ç±11.00</div></div>
                        <div class="qr-section" onclick="openQRScanner()"><svg class="qr-icon" viewBox="0 0 24 24"><path d="M3 3h6v6H3V3zm2 2v2h2V5H5zm8-2h6v6h-6V3zm2 2v2h2V5h-2zM3 13h6v6H3v-6zm2 2v2h2v-2H5zm13-2h3v2h-3v-2zm-3 2h2v2h-2v-2zm3 2h3v2h-3v-2zM3 21h2v-2H3v2zm4 0h2v-2H7v2zm8-6h2v2h-2v-2zm-2 2h2v2h-2v-2zm4 2h2v2h-2v-2z"/></svg><div class="qr-text">Scan QR to pay.<br>Click here.</div></div>
                        <div class="ride-info"><small>Total to Pay</small>‚Ç± 11.00</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="account-menu" class="screen">
            <div class="menu-back" onclick="switchNav('home')"><svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></div>
            <div class="acc-header" onclick="openProfileEdit()">
                <div class="acc-avatar">CR</div>
                <div class="acc-info"><div class="acc-name">Calvin Raver Ricohermoso</div><div class="acc-sub">0912 345 6789 ‚Ä¢ Passenger | Student</div></div>
                <svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg>
            </div>
            <div class="acc-list-container">
                <div class="acc-item"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg><span class="acc-label">Credit Balance</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-item"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg><span class="acc-label">Saved</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-item"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/></svg><span class="acc-label">History</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-item"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/></svg><span class="acc-label">Notifications</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-item" onclick="openProfileEdit()"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg><span class="acc-label">Settings</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-item"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg><span class="acc-label">Terms and Conditions</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-item"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg><span class="acc-label">Help Center</span><svg class="acc-arrow" viewBox="0 0 24 24"><path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></div>
                <div class="acc-logout" onclick="handleLogout()"><svg class="acc-icon" viewBox="0 0 24 24"><path d="M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/></svg><span class="acc-label">Log Out</span></div>
            </div>
        </div>

        <div id="edit-profile" class="screen">
            <div class="profile-header-bg">
                <button class="back-btn-float" onclick="closeProfileEdit()"><svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button>
                <div class="p-header-name">Calvin Raver Ricohermoso</div><div class="p-header-sub">0912 345 6789</div>
                <div class="p-edit-avatar"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png"></div>
            </div>
            <div class="profile-form">
                <div class="section-title">Account Details</div>
                <div class="form-row"><div class="form-group" style="flex:1"><span class="form-label">First Name</span><input type="text" class="form-input" value="Calvin Raver"></div><div class="form-group" style="flex:1"><span class="form-label">Surname</span><input type="text" class="form-input" value="Ricohermoso"></div></div>
                <div class="form-group"><span class="form-label">Date of Birth</span><input type="text" class="form-input" value="MM/DD/YYYY"></div>
                <div class="form-row"><div class="form-group" style="flex:1"><span class="form-label">House No.</span><input type="text" class="form-input" value="##"></div><div class="form-group" style="flex:2"><span class="form-label">Street Name</span><input type="text" class="form-input" placeholder="Enter Street"></div></div>
                <div class="form-row"><div class="form-group" style="flex:1"><span class="form-label">Barangay</span><input type="text" class="form-input" placeholder="Enter Brgy"></div><div class="form-group" style="flex:1"><span class="form-label">Municipal</span><input type="text" class="form-input" placeholder="Enter Municipal"></div></div>
                <div class="form-row"><div class="form-group" style="flex:2"><span class="form-label">City</span><input type="text" class="form-input" value="Batangas City"></div><div class="form-group" style="flex:1"><span class="form-label">ZIP Code</span><input type="text" class="form-input" value="4200"></div></div>
                <div class="form-group"><span class="form-label">Country</span><input type="text" class="form-input" value="Philippines"></div>
                <div class="form-group"><span class="form-label">Nationality</span><input type="text" class="form-input" value="Filipino"></div>
            </div>
        </div>

        <div id="qr-screen" class="screen">
            <div class="qr-header"><button class="icon-btn" onclick="closeQRScanner()"><svg class="icon-white" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button><h2>QR Reader</h2><div style="width:40px"></div></div>
            <div class="camera-view"><div class="camera-feed-bg"></div><div class="scanner-box"><div class="scan-line"></div></div><div class="qr-modal" id="qr-modal"><span class="modal-title">How to scan?</span><span class="modal-text">Scan the given QR code inside the box.</span><button class="btn-ok" onclick="hideModal()">OK</button></div></div>
            <div class="qr-controls"><div class="btn-row"><button class="circle-btn" onclick="openGenerateScreen()"><span class="plus-icon">+</span></button><button class="circle-btn" onclick="openUploadScreen()"><svg class="icon-white" style="fill:#888" viewBox="0 0 24 24"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg></button></div><div class="labels-row"><span class="label-text">Generate QR</span><span class="label-text">Upload QR</span></div></div>
        </div>

        <div id="generate-screen" class="screen" style="background:#f4f7fa">
            <div class="qr-header"><button class="icon-btn" onclick="closeSubScreen('generate-screen')"><svg class="icon-white" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button><h2>My QR Code</h2><div style="width:40px"></div></div>
            <div class="sub-content">
                <h3 style="color:#333; margin-bottom:10px;">Generate a QR Code to pay.</h3>
                <div class="qr-display-card" onclick="openReceipt()">
                    <div style="display:flex; gap:10px; margin-bottom:10px;"><div style="width:30px; height:30px; border:2px dashed #164A86; border-radius:5px;"></div><div style="width:30px; height:30px; border:2px dashed #164A86; border-radius:5px;"></div></div>
                    <h4 style="color:#164A86; margin:0;">Pay Using QR Code</h4>
                    <p style="text-align:center; font-size:12px; color:#888; margin:10px 0;">Show any of these codes to the driver to pay.</p>
                    <img class="generated-qr-img" src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=JeepneyFarePay" alt="QR">
                </div>
                <div class="pay-option-row"><div class="gcash-btn">GCash</div><div style="flex:1; margin-left:15px;"><h4 style="margin:0; font-size:14px; color:#333;">Pay Using GCash</h4></div></div>
            </div>
        </div>

        <div id="upload-screen" class="screen" style="background:#f4f7fa">
            <div class="qr-header"><button class="icon-btn" onclick="closeSubScreen('upload-screen')"><svg class="icon-white" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button><h2>Upload QR Code</h2><div style="width:40px"></div></div>
            <div class="upload-tabs"><button class="u-tab active" id="tab-photos" onclick="switchUploadTab('photos')">Photos</button><button class="u-tab inactive" id="tab-colls" onclick="switchUploadTab('collections')">Collections</button></div>
            <div class="sub-content" style="padding-top:10px;">
                <div id="view-photos" class="photo-grid">
                    <div class="photo-item" onclick="openReceipt()"><img src="https://picsum.photos/200/300?random=1"></div>
                    <div class="photo-item" onclick="openReceipt()"><img src="https://picsum.photos/200/300?random=2"></div>
                    <div class="photo-item" onclick="openReceipt()"><img src="https://picsum.photos/200/300?random=3"></div>
                    <div class="photo-item" onclick="openReceipt()"><img src="https://picsum.photos/200/300?random=4"></div>
                    <div class="photo-item" onclick="openReceipt()"><img src="https://picsum.photos/200/300?random=5"></div>
                    <div class="photo-item" onclick="openReceipt()"><img src="https://picsum.photos/200/300?random=6"></div>
                </div>
                <div id="view-collections" class="collection-list" style="display:none;">
                    <div class="coll-row"><div class="coll-card" onclick="openReceipt()"><div class="coll-thumb"><img src="https://picsum.photos/200/300?random=10"></div><div class="coll-title">Favorites</div><div class="coll-count">12 Photos</div></div><div class="coll-card" onclick="openReceipt()"><div class="coll-thumb"><img src="https://picsum.photos/200/300?random=11"></div><div class="coll-title">Camera</div><div class="coll-count">48 Photos</div></div></div>
                    <div class="coll-row"><div class="coll-card" onclick="openReceipt()"><div class="coll-thumb"><img src="https://picsum.photos/200/300?random=12"></div><div class="coll-title">Screenshots</div><div class="coll-count">5 Photos</div></div><div class="coll-card" onclick="openReceipt()"><div class="coll-thumb"><img src="https://picsum.photos/200/300?random=13"></div><div class="coll-title">Downloads</div><div class="coll-count">9 Photos</div></div></div>
                </div>
            </div>
        </div>

        <div id="receipt-screen" class="screen" style="background:#f0f0f0;">
            <div class="qr-header"><button class="icon-btn" onclick="closeReceipt()"><svg class="icon-white" viewBox="0 0 24 24"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg></button><h2>Receipt</h2><div style="width:40px"></div></div>
            <div class="receipt-card">
                <div style="font-size:30px; font-weight:bold; color:#164A86; margin-bottom:10px;">‚Ç±</div>
                <div style="text-align:center;">
                    <div style="width:60px; height:60px; background:#ddd; border-radius:50%; margin:0 auto 10px auto; overflow:hidden;"><svg viewBox="0 0 24 24" fill="#555"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg></div>
                    <div style="font-weight:800; color:#164A86; font-size:18px;">J**** A** A.</div>
                    <div style="background:#eee; padding:2px 8px; border-radius:5px; font-size:12px; margin-top:5px; display:inline-block;">+63 900 000 0000</div>
                </div>
                <div class="receipt-divider"></div>
                <div id="r-confirm-view" style="width:100%;">
                    <div class="r-row"><span class="r-label">Balance</span><span class="r-val">100.00</span></div>
                    <div class="r-row"><span class="r-label" style="font-size:12px;">Fare (Regular)</span><span class="r-val">15.00</span></div>
                    <div class="r-row"><span class="sub-detail">Quantity</span><span class="sub-detail">1</span></div>
                    <div class="r-row"><span class="r-label" style="font-size:12px;">Discount (Student)</span><span class="r-val">-4.00</span></div>
                    <div class="receipt-divider"></div>
                    <div class="r-row"><span class="r-total-label">Total Amount</span><span class="r-total-val">‚Ç±11.00</span></div>
                    <div class="confirm-box" onclick="toggleCheck()"><div class="checkbox-custom" id="r-check"></div><span style="font-size:12px; font-weight:600; color:#555;">Yes, I confirm that the information is correct.</span></div>
                    <div style="display:flex; justify-content:center;"><button id="btn-pay-action" class="pay-btn" onclick="confirmPayment()">PAY ‚Ç±11.00</button></div>
                </div>
                <div id="r-success-view" style="width:100%; display:none; flex-direction:column; align-items:center;">
                    <div class="success-icon"><span style="color:white; font-size:30px;">‚úì</span></div>
                    <div class="success-text">Paid Successfully!</div>
                    <div class="receipt-divider" style="width:100%"></div>
                    <div class="r-row"><span class="r-label">New Balance</span><span class="r-val">89.00</span></div>
                    <div class="r-row"><span class="r-total-label">Total Sent</span><span class="r-total-val">‚Ç±11.00</span></div>
                    <div style="margin-top:30px;"><button class="pay-btn enabled" style="background:#4CAF50" onclick="closeReceipt()">DONE</button></div>
                </div>
            </div>
        </div>

        <div class="bottom-nav">
             <div style="width: 30px"></div>
            <div class="map-fab" onclick="switchNav('home')">
                <svg class="map-icon" viewBox="0 0 24 24"><path d="M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"/></svg>
            </div>
            <svg class="nav-icon" id="nav-profile" onclick="switchNav('profile')" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
        </div>

    </div>

    <script>
        function handleLogin() { document.getElementById('login-screen').classList.remove('active'); document.getElementById('map-view').classList.add('active'); initMap(); }
        
        let map;
        function initMap() {
            if(map) return;
            map = L.map('map-canvas').setView([13.7565, 121.0583], 14);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            L.marker([13.7565, 121.0583]).addTo(map).bindPopup("Current Location").openPopup();
            setTimeout(() => { map.invalidateSize(); }, 200);
        }

        // NAV LOGIC
        function switchNav(screen) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('nav-profile').classList.remove('active');
            
            if(screen === 'home') {
                document.getElementById('map-view').classList.add('active');
            } else if(screen === 'profile') {
                document.getElementById('account-menu').classList.add('active');
                document.getElementById('nav-profile').classList.add('active');
            }
        }

        function handleLogout() { location.reload(); }

        // RIDE & QR LOGIC
        function triggerRidePanel() { document.getElementById('ride-panel').classList.add('show'); document.getElementById('find-btn').style.display='none'; }
        
        function toggleRideTab(idx) {
            const btnEta = document.getElementById('btn-eta');
            const btnPay = document.getElementById('btn-pay');
            const slider = document.getElementById('toggle-slider');
            if(idx === 0) { slider.style.transform='translateX(0)'; btnEta.classList.add('active'); btnPay.classList.remove('active'); document.getElementById('tab-eta').classList.add('active'); document.getElementById('tab-pay').classList.remove('active'); } 
            else { slider.style.transform='translateX(100%)'; btnPay.classList.add('active'); btnEta.classList.remove('active'); document.getElementById('tab-pay').classList.add('active'); document.getElementById('tab-eta').classList.remove('active'); }
        }

        function openQRScanner() { document.getElementById('qr-screen').classList.add('active'); }
        function closeQRScanner() { document.getElementById('qr-screen').classList.remove('active'); }
        function hideModal() { document.getElementById('qr-modal').style.display='none'; }
        
        function openGenerateScreen() { document.getElementById('generate-screen').classList.add('active'); }
        function openUploadScreen() { document.getElementById('upload-screen').classList.add('active'); switchUploadTab('photos'); }
        function closeSubScreen(id) { document.getElementById(id).classList.remove('active'); }

        // RECEIPT LOGIC
        function openReceipt() { document.getElementById('receipt-screen').classList.add('active'); document.getElementById('r-confirm-view').style.display='block'; document.getElementById('r-success-view').style.display='none'; }
        function closeReceipt() { document.getElementById('receipt-screen').classList.remove('active'); closeSubScreen('generate-screen'); closeSubScreen('upload-screen'); closeQRScanner(); }
        function toggleCheck() { document.getElementById('r-check').classList.toggle('checked'); document.getElementById('btn-pay-action').classList.toggle('enabled'); }
        function confirmPayment() { document.getElementById('r-confirm-view').style.display='none'; document.getElementById('r-success-view').style.display='flex'; }

        // PROFILE EDIT LOGIC
        function openProfileEdit() { document.getElementById('edit-profile').classList.add('active'); }
        function closeProfileEdit() { document.getElementById('edit-profile').classList.remove('active'); }
        
        function switchUploadTab(tabName) {
            const tabPhotos = document.getElementById('tab-photos');
            const tabColls = document.getElementById('tab-colls');
            const viewPhotos = document.getElementById('view-photos');
            const viewColls = document.getElementById('view-collections');

            if(tabName === 'photos') {
                tabPhotos.classList.add('active'); tabPhotos.classList.remove('inactive');
                tabColls.classList.remove('active'); tabColls.classList.add('inactive');
                viewPhotos.style.display = 'grid'; viewColls.style.display = 'none';
            } else {
                tabColls.classList.add('active'); tabColls.classList.remove('inactive');
                tabPhotos.classList.remove('active'); tabPhotos.classList.add('inactive');
                viewPhotos.style.display = 'none'; viewColls.style.display = 'flex';
            }
        }
    </script>
</body>
</html>
